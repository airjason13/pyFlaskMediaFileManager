<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>File browser</title>
</head>
<body>
  <h2>Browsing: /{{ current }}</h2>

  {% if current %}
    {% set parent = current.rsplit('/', 1)[0] if '/' in current else '' %}
    <a href="{{ url_for('browse', req_path=parent) }}">.. (parent)</a>
  {% endif %}

  <ul>
    {% for e in entries %}
      <li>
        {% if e.is_dir %}
          📁 <a href="{{ url_for('browse', req_path=(current + '/' + e.name).lstrip('/') ) }}">{{ e.name }}</a>
        {% else %}
          📄 {{ e.name }} —
          <a href="{{ url_for('download_file', filepath=(current + '/' + e.name).lstrip('/')) }}">下載</a>
        {% endif %}
      </li>
    {% endfor %}
  </ul>

  <hr>
  <form action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data">
    <input type="file" name="file" multiple>
    <button type="submit">上傳（允許 .mp4/.jpg/.png）</button>
  </form>
</body>
</html>
